{"version":3,"sources":["server/main.js"],"names":["app","PORT","process","env","NODE_ENV","config","webpackDevMiddleware","require","webpackHotMiddleware","webpackConfig","devBrowserConfig","compiler","use","hot","stats","hash","publicPath","output","filename","log","console","path","heartbeat","req","res","next","readFile","paths","dist","err","data","error","global","JSON","parse","get","listen"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;AAEA,IAAMA,MAAM,wBAAZ;AACA,IAAMC,OAAOC,QAAQC,GAAR,CAAYF,IAAZ,IAAoB,IAAjC;;AAEA,IAAIC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACzC,mBAAOC,MAAP;AACA;AACA,MAAMC,uBAAuBC,QAAQ,wBAAR,CAA7B;AACA,MAAMC,uBAAuBD,QAAQ,wBAAR,CAA7B;AACA,MAAME,gBAAgBF,QAAQ,yBAAR,CAAtB;AACA,MAAMG,mBAAmBD,cAAc,SAAd,CAAzB;AACA,MAAME,WAAW,uBAAQD,gBAAR,CAAjB;AACAV,MAAIY,GAAJ,CAAQN,qBAAqBK,QAArB,EAA+B;AACrCE,SAAK,IADgC;AAErCC,WAAO;AACLC,YAAM;AADD,KAF8B;AAKrCC,gBAAYN,iBAAiBO,MAAjB,CAAwBD,UALC;AAMrCE,cAAUR,iBAAiBO,MAAjB,CAAwBC;AANG,GAA/B,CAAR;;AASAlB,MAAIY,GAAJ,CAAQJ,qBAAqBG,QAArB,EAA+B;AACrCQ,SAAKC,QAAQD,GADwB;AAErCE,UAAM,gBAF+B;AAGrCC,eAAW,KAAK;AAHqB,GAA/B,CAAR;;AAMAtB,MAAIY,GAAJ,CAAQ,UAACW,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1B,iBAAGC,QAAH,CAAY,iBAAOC,KAAP,CAAaC,IAAb,GAAoB,aAAhC,EAA+C,UAACC,GAAD,EAAMC,IAAN,EAAe;AAC5D,UAAID,GAAJ,EAAST,QAAQW,KAAR,CAAcF,GAAd;AACTG,aAAOjB,IAAP,GAAckB,KAAKC,KAAL,CAAWJ,IAAX,EAAiBf,IAA/B;AACAU;AACD,KAJD;AAKD,GAND;AAOD;;AAED,4BAAazB,GAAb;;AAEAA,IAAImC,GAAJ,CAAQ,GAAR;;AAEAnC,IAAIoC,MAAJ,CAAWnC,IAAX","file":"main.js","sourceRoot":"/Volumes/Git HD/Code/openclub","sourcesContent":["import express from 'express';\nimport webpack from 'webpack';\nimport dotenv from 'dotenv';\nimport setupExpress from './setupExpress';\nimport fs from 'fs';\n\nimport middleware from './middleware';\nimport config from '../config';\n\nconst app = express();\nconst PORT = process.env.PORT || 3000;\n\nif (process.env.NODE_ENV !== 'production') {\n  dotenv.config();\n  // enable webpack hot module replacement\n  const webpackDevMiddleware = require('webpack-dev-middleware');\n  const webpackHotMiddleware = require('webpack-hot-middleware');\n  const webpackConfig = require('../build/webpack.config');\n  const devBrowserConfig = webpackConfig('browser');\n  const compiler = webpack(devBrowserConfig);\n  app.use(webpackDevMiddleware(compiler, {\n    hot: true,\n    stats: {\n      hash: true\n    },\n    publicPath: devBrowserConfig.output.publicPath,\n    filename: devBrowserConfig.output.filename\n  }));\n\n  app.use(webpackHotMiddleware(compiler, {\n    log: console.log,\n    path: '/__webpack_hmr',\n    heartbeat: 10 * 1000,\n  }));\n\n  app.use((req, res, next) => {\n    fs.readFile(config.paths.dist + '/stats.json', (err, data) => {\n      if (err) console.error(err);\n      global.hash = JSON.parse(data).hash;\n      next();\n    });\n  });\n}\n\nsetupExpress(app);\n\napp.get('*', middleware);\n\napp.listen(PORT);\n"]}