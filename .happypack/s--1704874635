'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CoreLayout = undefined;

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _taggedTemplateLiteral2 = require('babel-runtime/helpers/taggedTemplateLiteral');

var _taggedTemplateLiteral3 = _interopRequireDefault(_taggedTemplateLiteral2);

var _templateObject = (0, _taggedTemplateLiteral3.default)(['\n  query currentViewer {\n    user {\n      _id\n      email\n      name\n      images {\n        thumb\n        square\n      }\n      clubs {\n        _id\n        slug\n        name\n        images {\n          thumb\n        }\n      }\n    }\n  }\n'], ['\n  query currentViewer {\n    user {\n      _id\n      email\n      name\n      images {\n        thumb\n        square\n      }\n      clubs {\n        _id\n        slug\n        name\n        images {\n          thumb\n        }\n      }\n    }\n  }\n']);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactRedux = require('react-redux');

var _reactApollo = require('react-apollo');

var _graphqlTag = require('graphql-tag');

var _graphqlTag2 = _interopRequireDefault(_graphqlTag);

var _classnames = require('classnames');

var _classnames2 = _interopRequireDefault(_classnames);

var _actions = require('modules/auth/actions');

var authActions = _interopRequireWildcard(_actions);

var _Header = require('../../components/Header');

var _Header2 = _interopRequireDefault(_Header);

var _Sidebar = require('../../components/Sidebar');

var _Sidebar2 = _interopRequireDefault(_Sidebar);

require('./styles');

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var CoreLayout = function CoreLayout(_ref) {
  var _ref$data = _ref.data,
      data = _ref$data === undefined ? {} : _ref$data,
      children = _ref.children,
      location = _ref.location,
      logoutUser = _ref.logoutUser;

  var user = data.user;
  var containerClasses = (0, _classnames2.default)('layout-container', {
    'sidebar-offcanvas': !user,
    'loggedout': !user
  });
  var contentClasses = (0, _classnames2.default)('main-container', {
    full: !user
  });

  return _react2.default.createElement(
    'div',
    { className: containerClasses },
    _react2.default.createElement(_Header2.default, { user: user }),
    user && _react2.default.createElement(_Sidebar2.default, { user: user, location: location }),
    user && _react2.default.createElement('div', { className: 'sidebar-layout-obfuscator' }),
    _react2.default.createElement(
      'div',
      { className: contentClasses },
      children
    )
  );
};

CoreLayout.PropTypes = {
  children: _react.PropTypes.element.isRequired,
  data: _react.PropTypes.object,
  logoutUser: _react.PropTypes.func
};

CoreLayout.defaultProps = {
  data: {}
};

var currentViewer = (0, _graphqlTag2.default)(_templateObject);

// connect to apollo
var CoreLayoutWithApollo = (0, _reactApollo.graphql)(currentViewer, {
  skip: function skip(ownProps) {
    return !ownProps.token;
  }
})(CoreLayout);

// connect to redux
exports.default = (0, _reactRedux.connect)(function (state) {
  return {
    token: state.auth.token
  };
}, (0, _extends3.default)({}, authActions))(CoreLayoutWithApollo);
exports.CoreLayout = CoreLayout;