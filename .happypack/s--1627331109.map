{"version":3,"sources":["server/middleware.js"],"names":["middleware","req","res","memoryHistory","store","routes","location","url","err","redirect","props","status","json","pathname","search","send","sendStatus"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,SAASA,UAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA8B;AAC5B,MAAMC,gBAAgB,uCAAtB;AACA,MAAMC,QAAQ,qBAAYD,aAAZ,CAAd;AACA,MAAME,SAAS,sBAAaD,KAAb,CAAf;;AAEA,0BAAM,EAACC,cAAD,EAASC,UAAUL,IAAIM,GAAvB,EAAN,EAAmC,UAACC,GAAD,EAAMC,QAAN,EAAgBC,KAAhB,EAA0B;AAC3D,QAAIF,GAAJ,EAAS;AACPN,UAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBJ,GAArB;AACD,KAFD,MAEO,IAAIC,QAAJ,EAAc;AACnBP,UAAIO,QAAJ,CAAa,GAAb,EAAkBA,SAASI,QAAT,GAAoBJ,SAASK,MAA/C;AACD,KAFM,MAEA,IAAIJ,KAAJ,EAAW;AAChBR,UAAIS,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqB,sBAAWX,KAAX,EAAkBM,KAAlB,CAArB;AACD,KAFM,MAEA;AACLR,UAAIc,UAAJ,CAAe,GAAf;AACD;AACF,GAVD;AAWD;;kBAEchB,U","file":"middleware.js","sourceRoot":"/Volumes/Git HD/Code/openclub","sourcesContent":["import { createMemoryHistory, match } from 'react-router';\nimport createStore from '../src/store';\nimport createRoutes from '../src/routes';\nimport renderPage from './render';\n\nfunction middleware(req, res) {\n  const memoryHistory = createMemoryHistory();\n  const store = createStore(memoryHistory);\n  const routes = createRoutes(store);\n\n  match({routes, location: req.url}, (err, redirect, props) => {\n    if (err) {\n      res.status(500).json(err);\n    } else if (redirect) {\n      res.redirect(302, redirect.pathname + redirect.search);\n    } else if (props) {\n      res.status(200).send(renderPage(store, props));\n    } else {\n      res.sendStatus(404);\n    }\n  });\n}\n\nexport default middleware;\n"]}